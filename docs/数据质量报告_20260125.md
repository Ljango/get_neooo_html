# 图谱数据质量报告

**生成日期**: 2026-01-25  
**报告类型**: 数据对比、修订与导入报告

---

## 一、概述

本报告记录了对 `图谱数据/` 目录中的 JSON 数据与本地及远程 Neo4j 数据库的对比分析，以及发现的数据格式问题修复过程和最终导入结果。

---

## 二、数据对比分析

### 2.1 三方数据量对比

| 数据源 | 节点数 | 关系数 | 说明 |
|-------|-------|-------|------|
| 图谱数据目录 (JSON) | 7,662 | 30,295 | 原始数据源 |
| 本地 graph0128（修复前） | 6,216 | 20,443 | 部分学科导入失败 |
| 本地 graph0128（修复后） | 6,608 | 26,466 | 全部学科导入成功 |
| 远程测试环境 | 8,136+ | 33,515+ | 含历史数据 |

### 2.2 各学科导入对比

| 学科 | JSON源节点 | 本地（修复前） | 本地（修复后） | 状态变化 |
|-----|-----------|--------------|--------------|---------|
| 高中语文 | 48 | 48 | 48 | ✅ 一致 |
| 高中数学 | 403 | 403 | 403 | ✅ 一致 |
| 高中英语 | 296 | 31 | **296** | ✅ **已修复** |
| 高中物理 | 545 | 545 | 545 | ✅ 一致 |
| 高中化学 | 329 | 329 | 329 | ✅ 一致 |
| 高中生物 | 282 | 288 | 282 | ✅ 一致 |
| 高中政治 | 429 | 330 | **408** | ✅ **已修复** |
| 高中历史 | 246 | 246 | 246 | ✅ 一致 |
| 高中地理 | 350 | 275 | **350** | ✅ **已修复** |
| 义教语文 | 40 | 40 | 40 | ✅ 一致 |
| 义教数学 | 1346 | 1329 | 1329 | ✅ 一致 |
| 义务英语 | 673 | - | - | ⚠️ 标签不同 |
| 义教物理89全册 | 396 | 395 | 395 | ✅ 一致 |
| 义教物理8上下9全册 | 393 | 392 | 392 | ✅ 一致 |
| 义教化学 | 107 | 107 | 107 | ✅ 一致 |
| 义教生物 | 223 | 223 | 223 | ✅ 一致 |
| 义教道法 | 497 | 453 | 453 | ✅ 一致 |
| 义教历史 | 259 | 235 | 259 | ✅ 一致 |
| 义教地理 | 124 | 124 | 124 | ✅ 一致 |

---

## 三、发现的数据格式问题

### 3.1 高中英语-v2（严重）

**问题描述**: 实体类型名称包含中文括号 `（）`，Neo4j 标签不支持中文字符。

**影响范围**: 5 个实体文件，共 216 条数据

| 原类型 | 修复后类型 | 数据条数 |
|-------|----------|---------|
| `Chapter（必修）` | `ChapterBixiu` | 9 |
| `Chapter（选必修）` | `ChapterXuanbixiu` | 12 |
| `Section（必修）` | `SectionBixiu` | 72 |
| `Section（选必修）` | `SectionXuanbixiu` | 87 |
| `Subsection（必修）` | `SubsectionBixiu` | 36 |

**修复操作**:
1. 修改 JSON 文件中的 `type` 字段
2. 重命名 JSON 文件名
3. 更新 `src/config.py` 添加新实体类型映射

### 3.2 高中地理-v3（中等）

**问题描述**: 实体类型名称包含中划线 `-`，虽然 Neo4j 技术上支持，但不符合命名规范。

**影响范围**: 1 个实体文件，共 12 条数据

| 原类型 | 修复后类型 | 数据条数 |
|-------|----------|---------|
| `CoreLiteracy-level` | `CoreLiteracyLevel` | 12 |

**修复操作**:
1. 修改 JSON 文件中的 `type` 字段
2. 重命名 JSON 文件名
3. 更新 `src/config.py` 配置

### 3.3 高中政治-v3（轻微）

**问题描述**: 实体类型名称包含空格，不符合标识符规范。

**影响范围**: 1 个实体文件，共 5 条数据

| 原类型 | 修复后类型 | 数据条数 |
|-------|----------|---------|
| `Academic ProficiencyTestSuggestions` | `AcademicProficiencyTestSuggestions` | 5 |

**修复操作**:
1. 修改 JSON 文件中的 `type` 字段
2. 重命名 JSON 文件名

---

## 四、修复记录

### 4.1 修改的文件清单

#### 实体文件（已重命名）

```
图谱数据/高中英语-v2/entities/
├── Chapter（必修）.json → ChapterBixiu.json
├── Chapter（选必修）.json → ChapterXuanbixiu.json
├── Section（必修）.json → SectionBixiu.json
├── Section（选必修）.json → SectionXuanbixiu.json
└── Subsection（必修）.json → SubsectionBixiu.json

图谱数据/高中地理-v3/entities/
└── CoreLiteracy-level.json → CoreLiteracyLevel.json

图谱数据/高中政治-v3/entities/
└── Academic Proficiency Test Suggestions.json → AcademicProficiencyTestSuggestions.json
```

#### 配置文件

```
src/config.py - 添加新实体类型映射:
  - ChapterBixiu: "章（必修）"
  - ChapterXuanbixiu: "章（选必修）"
  - SectionBixiu: "节（必修）"
  - SectionXuanbixiu: "节（选必修）"
  - SubsectionBixiu: "小节（必修）"
  - CoreLiteracyLevel: "核心素养水平"
  - AcademicProficiencyTestSuggestions: "学业水平考试建议"
```

---

## 五、导入结果

### 5.1 本地 graph0128 数据库

**导入状态**: ✅ 19/19 学科成功

| 指标 | 数值 |
|-----|------|
| 总节点数 | 6,608 |
| 总关系数 | 26,466 |
| 成功学科 | 19/19 |

**各学科节点分布**:

| 学科标签 | 节点数 |
|---------|-------|
| GaoZhongDiLi | 350 |
| GaoZhongHuaXue | 329 |
| GaoZhongLiShi | 246 |
| GaoZhongShengWu | 282 |
| GaoZhongShuXue | 403 |
| GaoZhongWuLi | 545 |
| GaoZhongYingYu | 296 |
| GaoZhongYuWen | 48 |
| GaoZhongZhengZhi | 408 |
| YiJiaoDaoFa | 453 |
| YiJiaoDiLi | 124 |
| YiJiaoHuaXue | 107 |
| YiJiaoLiShi | 259 |
| YiJiaoShengWu | 223 |
| YiJiaoShuXue | 1,329 |
| YiJiaoWuLi | 392 |
| YiJiaoWuLi89 | 395 |
| YiJiaoYuWen | 40 |

### 5.2 远程测试环境

**导入状态**: ✅ 16/19 学科成功

| 结果 | 学科 |
|-----|------|
| ✅ 成功 | 高中语文, 高中数学, 高中英语, 高中物理, 高中化学, 高中生物, 高中政治, 高中历史, 高中地理, 义教语文, 义务英语, 义教化学, 义教生物, 义教道法, 义教历史, 义教地理 |
| ❌ 失败 | 义教数学, 义教物理89全册, 义教物理8上下9全册 |

**失败原因**: 远程数据库中已存在相同 `identifier` 的节点，触发唯一约束冲突。这是预期行为，表示这些学科的数据已在之前的导入中存在。

---

## 六、建议

### 6.1 数据规范建议

1. **实体类型命名**: 使用驼峰命名法（CamelCase），避免特殊字符
   - ✅ 正确: `ChapterBixiu`, `CoreLiteracyLevel`
   - ❌ 错误: `Chapter（必修）`, `CoreLiteracy-level`

2. **文件命名**: 与实体类型保持一致，避免空格和中文字符

3. **数据一致性**: 定期对比 JSON 源数据与数据库数据，确保同步

### 6.2 远程环境建议

对于远程测试环境中的冲突数据，可选择以下方案：

1. **保留现有数据**: 接受当前状态，新数据已通过 MERGE 更新
2. **清空重导**: 如需完全同步，可清空远程数据库后重新导入
3. **增量更新**: 开发增量更新脚本，只处理变更的数据

---

## 七、总结

本次数据质量检查和修复工作：

- ✅ 发现并修复了 3 个学科的实体类型命名问题
- ✅ 本地数据库成功导入全部 19 个学科（6,608 节点，26,466 关系）
- ✅ 远程测试环境成功更新 16 个学科
- ✅ 更新了配置文件以支持新的实体类型

---

*报告生成时间: 2026-01-25*
