# 知识图谱数据审校系统 - 快速开始

## 一、本地开发（推荐）

### 1. 安装依赖
```bash
pip install -r requirements.txt
```

### 2. 初始化测试数据
```bash
python tests/test_data.py
```

这将创建：
- SQLite数据库（`data/review.db`）
- root账号和4个测试账号
- 示例审核记录

### 3. 启动服务
```bash
python server.py --reload --port 8011
```

### 4. 访问系统
- **首页**：http://localhost:8011
- **登录页**：http://localhost:8011/static/app/login.html
- **API文档**：http://localhost:8011/docs

### 5. 测试账号

| 用户名 | 密码 | 角色 | 说明 |
|--------|------|------|------|
| root | root123 | root | 系统管理员，可以访问所有功能 |
| admin1 | admin123 | admin | 管理员，可以管理用户 |
| teacher1 | teacher123 | teacher | 数学老师（已分配高中数学） |
| teacher2 | teacher123 | teacher | 物理老师（已分配高中物理、义教物理） |
| teacher3 | teacher123 | teacher | 化学老师（已分配高中化学） |

## 二、功能测试

### 1. 基本功能测试流程

#### 登录 (所有角色)
1. 访问 http://localhost:8011
2. 点击"进入数据审校系统"按钮
3. 使用测试账号登录
4. **首次登录**建议修改密码

#### 审核数据 (teacher+)
1. 登录后进入"工作台"
2. 查看已分配的学科
3. 点击学科卡片进入"数据审核"页面
4. 选择实体或关系进行审核
5. 提交审核意见：通过/需修改

#### 用户管理 (admin+)
1. 点击左侧菜单"用户管理"
2. 查看用户列表
3. 创建新用户
4. 为用户分配学科
5. 重置用户密码

#### 系统管理 (仅root)
1. 点击左侧菜单"系统管理"
2. 选择学科（或留空表示全部）
3. 执行数据操作：
   - 检查数据规范
   - 质量分析
   - 生成HTML图谱
   - 导入Neo4j
   - 导出Excel

### 2. API测试
```bash
python tests/test_api.py
```

这将自动测试：
- ✅ 健康检查
- ✅ 登录认证
- ✅ 用户管理
- ✅ 学科分配
- ✅ 审核功能
- ✅ 静态文件

## 三、常见问题

### Q: 登录后提示"密码错误"
**A**: 确保已运行 `python tests/test_data.py` 初始化数据库

### Q: 页面显示"加载失败"
**A**: 
1. 检查服务是否正常运行
2. 打开浏览器开发者工具查看网络请求
3. 检查控制台是否有错误

### Q: "数据审核"页面没有数据
**A**: 
1. 确保有真实的图谱数据在 `图谱数据/` 目录
2. 检查 `src/config.py` 中的学科配置是否正确

### Q: 数据库权限错误
**A**: 
```bash
chmod 644 data/review.db
chmod 755 data
```

### Q: 重置所有数据
**A**: 
```bash
python tests/test_data.py --reset
```

## 四、开发模式切换

### SQLite (默认，本地开发)
无需配置，自动创建 `data/review.db`

### MySQL (生产环境)
在 `.env` 文件中配置：
```bash
DB_TYPE=mysql
MYSQL_HOST=localhost
MYSQL_PORT=3306
MYSQL_USER=root
MYSQL_PASSWORD=your_password
MYSQL_DATABASE=knowledge_graph
```

## 五、目录结构
```
.
├── server.py              # FastAPI服务入口
├── src/
│   ├── config.py         # 学科配置
│   └── api/              # API模块
│       ├── auth.py       # 认证
│       ├── review.py     # 审核
│       ├── admin.py      # 管理
│       └── data.py       # 数据操作
├── static/
│   ├── index.html        # 图谱导航页
│   └── app/              # 审校系统页面
│       ├── login.html
│       ├── dashboard.html
│       ├── review.html
│       ├── admin.html
│       └── system.html
├── tests/
│   ├── test_data.py      # 测试数据生成
│   └── test_api.py       # API自动化测试
└── data/
    └── review.db         # SQLite数据库
```

## 六、下一步

1. **自定义学科配置** - 编辑 `src/config.py`
2. **创建真实用户** - 在"用户管理"页面添加
3. **分配审核任务** - 为教师分配负责的学科
4. **开始审核** - 教师登录开始数据审核
5. **查看进度** - admin/root查看全局统计

## 七、生产部署

参考 `docs/部署指南.md` 使用Docker部署到服务器。
